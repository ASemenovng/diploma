import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.dates as mdates


def calculate_difference(total_returns, price_returns):
    difference = {}
    for date in total_returns.keys():
        if date in price_returns:
            diff = total_returns[date] - price_returns[date]
            difference[date] = diff
    return difference


def plot_returns(price_returns, dividend_returns, name):
   
    dates = sorted(list(price_returns.keys()))

   
    price_values = [price_returns[date] for date in dates]
    dividend_values = [dividend_returns[date] for date in dates]

   
    num_items = len(dates)

   
    positions = np.arange(num_items)

   
    fig, ax = plt.subplots(figsize=(10, 3))

   
    ax.bar(positions, price_values, label='Курсовая доходность', color='b', alpha=0.7)

   
    ax.bar(positions, dividend_values, bottom=price_values, label='Дивидендная доходность', color='lightblue', alpha=0.7)

   
    ax.set_xticks(positions)
    ax.set_xticklabels(dates, rotation=45, ha='right')

   
    for i, label in enumerate(ax.get_xticklabels()):
        if i % 6 != 0 and i % 12 != 0:
            label.set_visible(False)

    y_ticks = np.arange(100, 500, 50)
    ax.set_yticks(y_ticks)
    ax.grid(axis='y', linestyle='--', alpha=0.7)

   
    ax.legend()

   
    ax.set_title(f"Доходность портфеля {name}")
    ax.set_xlabel('Дата')
    ax.set_ylabel('Доходность (%)')

   
    plt.tight_layout()
    plt.show()



cum_no_dividend_avg_bc = {'2013-01': 2.8892468376490843, '2013-02': 10.962184664097286, '2013-03': 4.775359782162525, '2013-04': -5.519628582002245, '2013-05': -9.925742245466651, '2013-06': -11.666038260894195, '2013-07': -11.175426624339213, '2013-08': -8.627424246958382, '2013-09': -13.450679311131363, '2013-10': -12.254826290143539, '2013-11': -14.136751189752438, '2013-12': -19.192169752556676, '2014-01': -16.618408874179647, '2014-02': -19.397555156265845, '2014-03': -24.67472280527564, '2014-04': -28.117809513513592, '2014-05': -31.589293300789844, '2014-06': -21.71573003983147, '2014-07': -23.66758218893148, '2014-08': -27.410877248460107, '2014-09': -28.232537811245063, '2014-10': -30.55734657690785, '2014-11': -28.35771784273813, '2014-12': -22.681678699688256, '2015-01': -16.345095030463817, '2015-02': -6.336620053974085, '2015-03': 6.7279818749764075, '2015-04': -0.48517174646590666, '2015-05': 9.68153616926648, '2015-06': 11.86373035174868, '2015-07': 11.061008798644023, '2015-08': 13.004026175780869, '2015-09': 16.694104513513253, '2015-10': 19.330335952448042, '2015-11': 23.133845888639335, '2015-12': 25.98627344917981, '2016-01': 29.816514285585804, '2016-02': 24.80310483401409, '2016-03': 33.72157694793516, '2016-04': 47.14261667037687, '2016-05': 62.71861099544442, '2016-06': 74.46699743492913, '2016-07': 78.74305956173143, '2016-08': 86.11165296239693, '2016-09': 92.53590599921941, '2016-10': 104.41583946165225, '2016-11': 104.01658989335752, '2016-12': 112.67060124854086, '2017-01': 129.6082339801869, '2017-02': 148.63710512420494, '2017-03': 123.5932793682533, '2017-04': 121.26748310331985, '2017-05': 147.4567181831583, '2017-06': 136.9738322946365, '2017-07': 148.07704158328815, '2017-08': 152.94965922733863, '2017-09': 167.82594363831902, '2017-10': 166.5901561495399, '2017-11': 154.10733720916744, '2017-12': 145.30407372363877, '2018-01': 155.51249864760584, '2018-02': 167.89742731894162, '2018-03': 169.46072767629147, '2018-04': 161.5053626745027, '2018-05': 157.48350867011584, '2018-06': 152.07634076050445, '2018-07': 151.45623250193924, '2018-08': 146.26373339880524, '2018-09': 137.82846257833538, '2018-10': 146.76044919701218, '2018-11': 136.52430766095625, '2018-12': 149.79021261437794, '2019-01': 141.11828448182706, '2019-02': 156.3035460789623, '2019-03': 163.1964069993201, '2019-04': 164.3455142452546, '2019-05': 172.4763271859933, '2019-06': 170.25330129158687, '2019-07': 183.8142093054807, '2019-08': 190.55530444115382, '2019-09': 196.95095545663685, '2019-10': 202.69128815157694, '2019-11': 203.35319924138372, '2019-12': 207.60126157709408, '2020-01': 230.90224889803662, '2020-02': 260.08673537499243, '2020-03': 238.60243530012224, '2020-04': 187.93301651501372, '2020-05': 209.52805018977884, '2020-06': 216.80059262663005, '2020-07': 213.27941359438364, '2020-08': 230.63161446717749, '2020-09': 240.00754254341342, '2020-10': 242.39276711979403, '2020-11': 221.57374965501774, '2020-12': 282.6723313114259, '2021-01': 282.66519110024257, '2021-02': 280.1928575334722, '2021-03': 304.25883827246753, '2021-04': 332.5577691517474, '2021-05': 347.86779759628484, '2021-06': 356.0683530812683, '2021-07': 344.775210225253, '2021-08': 345.4865853748422, '2021-09': 370.00747718055146, '2021-10': 394.5190167889087, '2021-11': 412.41304477947267, '2021-12': 387.05106592712883, '2022-01': 383.015776087223, '2022-02': 352.5590335344372, '2022-03': 225.37345109048536, '2022-04': 261.03157259107337, '2022-05': 234.42146921836235, '2022-06': 216.10413261648424, '2022-07': 208.68026959761497, '2022-08': 202.87109739263195, '2022-09': 215.6761120410224, '2022-10': 154.16137637765252, '2022-11': 196.90716733671172, '2022-12': 201.22458053731768}
cum_below_median_avg_bc = {'2013-01': 4.163567020897729, '2013-02': 10.215177420118948, '2013-03': 5.022332808311258, '2013-04': -3.4507327699917156, '2013-05': -8.544322230067259, '2013-06': -8.56602099058712, '2013-07': -7.907039939185467, '2013-08': -4.875588339217973, '2013-09': -6.205107919161601, '2013-10': -5.778201725934884, '2013-11': -4.992288770395492, '2013-12': -7.104866152816691, '2014-01': 2.930550968575152, '2014-02': 0.5342687518388178, '2014-03': -9.29705287510184, '2014-04': -11.017471570503911, '2014-05': -18.494812133505757, '2014-06': -6.003992359032429, '2014-07': -5.703131255962301, '2014-08': -12.715298296677169, '2014-09': -7.6777279168381956, '2014-10': -7.631477358433047, '2014-11': -8.224056770547683, '2014-12': -5.484098985538943, '2015-01': -10.504269760066343, '2015-02': 4.568753003165904, '2015-03': 19.981662004052293, '2015-04': 9.135479817271609, '2015-05': 15.023365857312232, '2015-06': 16.818188649848942, '2015-07': 17.49954763884507, '2015-08': 14.755304837436633, '2015-09': 18.776984986509284, '2015-10': 15.279074302968487, '2015-11': 26.291139034707676, '2015-12': 27.52978192085309, '2016-01': 31.14065650382889, '2016-02': 36.00887671871569, '2016-03': 47.4616645265088, '2016-04': 53.9704268100228, '2016-05': 59.647192059717334, '2016-06': 63.91035505765706, '2016-07': 68.83931410568276, '2016-08': 74.05198068254369, '2016-09': 81.19486527605669, '2016-10': 83.51304849038009, '2016-11': 93.5504956206553, '2016-12': 111.96263825592303, '2017-01': 119.56514993109563, '2017-02': 127.44682433924535, '2017-03': 109.69265279752113, '2017-04': 108.02935886547162, '2017-05': 112.91970913840466, '2017-06': 97.08357091617546, '2017-07': 95.61633525833417, '2017-08': 94.33426794129949, '2017-09': 103.83966135507579, '2017-10': 110.98991063553308, '2017-11': 113.04459999915748, '2017-12': 106.46704963609017, '2018-01': 110.44636931428711, '2018-02': 116.31446376359497, '2018-03': 115.27128506864103, '2018-04': 114.642898847459, '2018-05': 112.56746819705658, '2018-06': 109.64198962501159, '2018-07': 105.60934137437452, '2018-08': 106.43364233569321, '2018-09': 102.3099838640408, '2018-10': 110.86503163473856, '2018-11': 97.29452054132186, '2018-12': 101.92408084592203, '2019-01': 93.62456209375209, '2019-02': 106.1048535696905, '2019-03': 101.15389569419375, '2019-04': 96.62543740228915, '2019-05': 101.39652459092292, '2019-06': 107.83288770068454, '2019-07': 123.67175307660476, '2019-08': 126.64524993007755, '2019-09': 128.60036816366986, '2019-10': 128.25893680304205, '2019-11': 132.26009363973063, '2019-12': 139.2327928071736, '2020-01': 145.71324966728687, '2020-02': 162.26611518847426, '2020-03': 155.1013919337457, '2020-04': 129.68918842547333, '2020-05': 146.03187924398333, '2020-06': 152.34836295635418, '2020-07': 169.30875043224907, '2020-08': 197.76144899294485, '2020-09': 203.27969793188308, '2020-10': 191.04604866638516, '2020-11': 172.73859874982, '2020-12': 197.99037599359139, '2021-01': 209.58397781681737, '2021-02': 214.6206638295391, '2021-03': 226.16283025764653, '2021-04': 255.43794471509824, '2021-05': 245.6346318664332, '2021-06': 259.7717816572371, '2021-07': 257.96852514191943, '2021-08': 256.38109322650007, '2021-09': 289.6698631561957, '2021-10': 294.39539443351055, '2021-11': 296.6696978839955, '2021-12': 258.5939373789655, '2022-01': 262.3391703465377, '2022-02': 244.93392184132082, '2022-03': 140.53054472105043, '2022-04': 185.646884686349, '2022-05': 162.74584997070517, '2022-06': 149.0609356494724, '2022-07': 145.60229865979557, '2022-08': 138.3701204248033, '2022-09': 159.3731597453952, '2022-10': 99.40122002458713, '2022-11': 119.23987137059524, '2022-12': 121.05821759263358}
cum_above_median_avg_bc = {'2013-01': 11.093741026979442, '2013-02': 11.52116180788465, '2013-03': 5.484901842858703, '2013-04': 0.7142696136497984, '2013-05': -4.180618469354924, '2013-06': -10.445134064595507, '2013-07': -11.834228102391675, '2013-08': -3.8689362695219165, '2013-09': -1.1896915624595383, '2013-10': 3.70080217972093, '2013-11': 6.975114870803956, '2013-12': 1.7295693482074492, '2014-01': 4.588294331436393, '2014-02': 1.1660261810848116, '2014-03': 2.1776864428956655, '2014-04': 1.0675906149064662, '2014-05': 1.0289697524499042, '2014-06': 11.582549467464398, '2014-07': 16.406728883969947, '2014-08': 13.618865336941411, '2014-09': 15.291548999772854, '2014-10': 10.924926939566015, '2014-11': 22.2691253130769, '2014-12': 27.584323164041425, '2015-01': 14.214309933969504, '2015-02': 37.05203519864608, '2015-03': 53.69745890332138, '2015-04': 49.840432942836955, '2015-05': 56.86897647783991, '2015-06': 52.23684696524822, '2015-07': 54.94573568229446, '2015-08': 63.296179237320494, '2015-09': 72.78125641876431, '2015-10': 65.28049492493513, '2015-11': 70.81041481359867, '2015-12': 73.29333368496445, '2016-01': 72.43907251579982, '2016-02': 74.95642657690527, '2016-03': 88.78036960203855, '2016-04': 103.56543379369474, '2016-05': 117.19489955409337, '2016-06': 121.12650067277424, '2016-07': 122.25765278542626, '2016-08': 148.19421745471965, '2016-09': 151.83768680525267, '2016-10': 152.1172316696592, '2016-11': 161.39628232757363, '2016-12': 188.14282352619009, '2017-01': 210.4558958220776, '2017-02': 228.52110694218277, '2017-03': 203.54648872119432, '2017-04': 193.44053902125876, '2017-05': 189.84261981797994, '2017-06': 174.2932848217037, '2017-07': 177.13582608163412, '2017-08': 186.33207469181755, '2017-09': 206.93720258543178, '2017-10': 207.62314561659105, '2017-11': 211.99334643965756, '2017-12': 210.5575298532458, '2018-01': 207.2869421993334, '2018-02': 228.28910493992854, '2018-03': 231.4012776712286, '2018-04': 234.2536210394807, '2018-05': 244.35786991843824, '2018-06': 242.41408445728786, '2018-07': 252.18120696551924, '2018-08': 247.4084004773791, '2018-09': 252.54471240733406, '2018-10': 266.20209370480745, '2018-11': 245.36254695148614, '2018-12': 244.72993084112247, '2019-01': 241.82042719932073, '2019-02': 253.0593564310313, '2019-03': 251.94368387954844, '2019-04': 256.4468455370925, '2019-05': 256.74392002026553, '2019-06': 255.74429405901463, '2019-07': 267.61175790685974, '2019-08': 254.59738193826658, '2019-09': 250.72942283921685, '2019-10': 242.37614677936642, '2019-11': 243.74583332523576, '2019-12': 260.4840514321613, '2020-01': 278.76438222979766, '2020-02': 300.8777562210361, '2020-03': 286.58031963800096, '2020-04': 239.14381637046097, '2020-05': 262.93000565477456, '2020-06': 278.592098889638, '2020-07': 283.7238481308828, '2020-08': 308.0158252512989, '2020-09': 324.3124734350136, '2020-10': 333.83951759775357, '2020-11': 322.7900647551331, '2020-12': 366.077831938009, '2021-01': 400.4262039003474, '2021-02': 404.6794120128741, '2021-03': 408.457890156125, '2021-04': 423.85944387432926, '2021-05': 441.69502338398104, '2021-06': 462.01187741736777, '2021-07': 447.1952970742379, '2021-08': 449.8217642892559, '2021-09': 448.4775098652531, '2021-10': 431.7782608072746, '2021-11': 456.75231422295843, '2021-12': 444.4095281231494, '2022-01': 436.0726358221962, '2022-02': 411.9972587281948, '2022-03': 280.79086963001953, '2022-04': 345.10937242761185, '2022-05': 293.2389878954964, '2022-06': 293.1343068202071, '2022-07': 307.8646788971052, '2022-08': 308.9224326550262, '2022-09': 336.04058331408675, '2022-10': 250.2076772236175, '2022-11': 307.97792489274667, '2022-12': 306.7602734400234}
cum_mixed_avg_bc = {'2013-01': 3.5972563349659703, '2013-02': 10.554129191964478, '2013-03': 4.920566178645469, '2013-04': -4.36389233141905, '2013-05': -9.148326940774021, '2013-06': -9.939867267971126, '2013-07': -9.35571634871546, '2013-08': -6.54112739291558, '2013-09': -9.45799506984505, '2013-10': -8.670248347216836, '2013-11': -9.115133752841786, '2013-12': -12.612633472368916, '2014-01': -5.640710116596415, '2014-02': -8.08585405457377, '2014-03': -15.798599972922533, '2014-04': -18.15098749709094, '2014-05': -23.770979718061923, '2014-06': -12.232915936592914, '2014-07': -12.791862887690975, '2014-08': -18.297694515921126, '2014-09': -15.655342329532518, '2014-10': -16.57167664699265, '2014-11': -15.750690768012877, '2014-12': -11.497435392587308, '2015-01': -10.953240088719895, '2015-02': 2.4269019552425775, '2015-03': 17.39468740881669, '2015-04': 8.121780193710904, '2015-05': 16.3615739149229, '2015-06': 18.599274348450013, '2015-07': 18.853145735480425, '2015-08': 18.333307962991796, '2015-09': 22.572961080934494, '2015-10': 21.860771593334526, '2015-11': 30.447335054375557, '2015-12': 32.672125295771636, '2016-01': 36.69740716608938, '2016-02': 38.12414943036793, '2016-03': 49.27319148003513, '2016-04': 59.120874548658556, '2016-05': 69.19854905373096, '2016-06': 76.71962543643973, '2016-07': 81.83840460196137, '2016-08': 88.31258582721522, '2016-09': 95.75506890168116, '2016-10': 101.95357666617886, '2016-11': 108.9514665854086, '2016-12': 124.93767966882925, '2017-01': 137.6945042045775, '2017-02': 151.51582517289057, '2017-03': 129.50473076468896, '2017-04': 127.63978129627307, '2017-05': 143.01887854363065, '2017-06': 128.69355430058133, '2017-07': 132.84859907835926, '2017-08': 134.30820542589018, '2017-09': 147.03622150328326, '2017-10': 151.4578844698206, '2017-11': 147.6547942799075, '2017-12': 139.7974669788217, '2018-01': 146.85194262425338, '2018-02': 156.03997061228708, '2018-03': 156.03002849908435, '2018-04': 152.13401745417494, '2018-05': 149.01152691568993, '2018-06': 144.73427595696452, '2018-07': 141.88472354311247, '2018-08': 140.0957916698761, '2018-09': 133.70556859214582, '2018-10': 143.05963956030055, '2018-11': 129.94390346901255, '2018-12': 138.7542614303624, '2019-01': 129.79437307388895, '2019-02': 144.52675852238661, '2019-03': 144.9684393794209, '2019-04': 142.83163949146774, '2019-05': 149.59559185346754, '2019-06': 152.64841089290942, '2019-07': 168.70047114126328, '2019-08': 173.7659132441201, '2019-09': 178.04709468133407, '2019-10': 180.61298441733484, '2019-11': 183.46335559549712, '2019-12': 189.78851554386904, '2020-01': 203.12893904006663, '2020-02': 226.11987292020768, '2020-03': 213.45738302173865, '2020-04': 176.55385862526543, '2020-05': 196.8325316484532, '2020-06': 204.41316230473782, '2020-07': 216.13398886138083, '2020-08': 243.7775877181324, '2020-09': 251.61759800431156, '2020-10': 243.88025596230895, '2020-11': 222.72227314677545, '2020-12': 264.5931428145422, '2021-01': 273.62949153726504, '2021-02': 276.6967888652432, '2021-03': 294.4490963449804, '2021-04': 327.1046941168055, '2021-05': 325.5844796274221, '2021-06': 339.55959092278744, '2021-07': 334.2743472975389, '2021-08': 333.5045515497661, '2021-09': 367.9338728859509, '2021-10': 380.80516794905856, '2021-11': 389.23558129392245, '2021-12': 350.9777572657836, '2022-01': 350.11882984416786, '2022-02': 324.07005884719, '2022-03': 202.0834362793478, '2022-04': 242.94071413063594, '2022-05': 217.10142017555486, '2022-06': 200.16061989577548, '2022-07': 194.19341420907705, '2022-08': 187.80113486806894, '2022-09': 204.37684034206524, '2022-10': 141.6474849945306, '2022-11': 177.0868091043472, '2022-12': 180.71039994312486}


curs_no_dividend_avg_bc = {'2013-01': 2.8892468376490843, '2013-02': 10.962184664097286, '2013-03': 4.775359782162525, '2013-04': -5.519628582002245, '2013-05': -9.925742245466651, '2013-06': -11.666038260894195, '2013-07': -11.175426624339213, '2013-08': -8.627424246958382, '2013-09': -13.450679311131363, '2013-10': -12.254826290143539, '2013-11': -14.136751189752438, '2013-12': -19.192169752556676, '2014-01': -16.618408874179647, '2014-02': -19.397555156265845, '2014-03': -24.67472280527564, '2014-04': -28.117809513513592, '2014-05': -31.589293300789844, '2014-06': -21.71573003983147, '2014-07': -23.66758218893148, '2014-08': -27.410877248460107, '2014-09': -28.232537811245063, '2014-10': -30.55734657690785, '2014-11': -28.35771784273813, '2014-12': -22.681678699688256, '2015-01': -16.345095030463817, '2015-02': -6.336620053974085, '2015-03': 6.7279818749764075, '2015-04': -0.48517174646590666, '2015-05': 9.68153616926648, '2015-06': 11.86373035174868, '2015-07': 11.061008798644023, '2015-08': 13.004026175780869, '2015-09': 16.694104513513253, '2015-10': 19.330335952448042, '2015-11': 23.133845888639335, '2015-12': 25.98627344917981, '2016-01': 29.816514285585804, '2016-02': 24.80310483401409, '2016-03': 33.72157694793516, '2016-04': 47.14261667037687, '2016-05': 62.71861099544442, '2016-06': 74.46699743492913, '2016-07': 78.74305956173143, '2016-08': 86.11165296239693, '2016-09': 92.53590599921941, '2016-10': 104.41583946165225, '2016-11': 104.01658989335752, '2016-12': 112.67060124854086, '2017-01': 129.6082339801869, '2017-02': 148.63710512420494, '2017-03': 123.5932793682533, '2017-04': 121.26748310331985, '2017-05': 147.4567181831583, '2017-06': 136.9738322946365, '2017-07': 148.07704158328815, '2017-08': 152.94965922733863, '2017-09': 167.82594363831902, '2017-10': 166.5901561495399, '2017-11': 154.10733720916744, '2017-12': 145.30407372363877, '2018-01': 155.51249864760584, '2018-02': 167.89742731894162, '2018-03': 169.46072767629147, '2018-04': 161.5053626745027, '2018-05': 157.48350867011584, '2018-06': 152.07634076050445, '2018-07': 151.45623250193924, '2018-08': 146.26373339880524, '2018-09': 137.82846257833538, '2018-10': 146.76044919701218, '2018-11': 136.52430766095625, '2018-12': 149.79021261437794, '2019-01': 141.11828448182706, '2019-02': 156.3035460789623, '2019-03': 163.1964069993201, '2019-04': 164.3455142452546, '2019-05': 172.4763271859933, '2019-06': 170.25330129158687, '2019-07': 183.8142093054807, '2019-08': 190.55530444115382, '2019-09': 196.95095545663685, '2019-10': 202.69128815157694, '2019-11': 203.35319924138372, '2019-12': 207.60126157709408, '2020-01': 230.90224889803662, '2020-02': 260.08673537499243, '2020-03': 238.60243530012224, '2020-04': 187.93301651501372, '2020-05': 209.52805018977884, '2020-06': 216.80059262663005, '2020-07': 213.27941359438364, '2020-08': 230.63161446717749, '2020-09': 240.00754254341342, '2020-10': 242.39276711979403, '2020-11': 221.57374965501774, '2020-12': 282.6723313114259, '2021-01': 282.66519110024257, '2021-02': 280.1928575334722, '2021-03': 304.25883827246753, '2021-04': 332.5577691517474, '2021-05': 347.86779759628484, '2021-06': 356.0683530812683, '2021-07': 344.775210225253, '2021-08': 345.4865853748422, '2021-09': 370.00747718055146, '2021-10': 394.5190167889087, '2021-11': 412.41304477947267, '2021-12': 387.05106592712883, '2022-01': 383.015776087223, '2022-02': 352.5590335344372, '2022-03': 225.37345109048536, '2022-04': 261.03157259107337, '2022-05': 234.42146921836235, '2022-06': 216.10413261648424, '2022-07': 208.68026959761497, '2022-08': 202.87109739263195, '2022-09': 215.6761120410224, '2022-10': 154.16137637765252, '2022-11': 196.90716733671172, '2022-12': 201.22458053731768}
curs_below_median_avg_bc = {'2013-01': 4.021399899071132, '2013-02': 9.922777702458173, '2013-03': 4.6019196993821065, '2013-04': -3.978825509689543, '2013-05': -9.185944224966146, '2013-06': -9.348660479898651, '2013-07': -8.836270277632574, '2013-08': -5.976139068012099, '2013-09': -7.430798953595907, '2013-10': -7.149780789797755, '2013-11': -6.515405911895023, '2013-12': -8.734003455441696, '2014-01': 1.1254187380914216, '2014-02': -1.2288389657858834, '2014-03': -10.887744965198609, '2014-04': -12.577992023435879, '2014-05': -19.924199620359474, '2014-06': -7.652436104187432, '2014-07': -7.3568513167392435, '2014-08': -14.246043316403423, '2014-09': -9.296818724772205, '2014-10': -9.251379280005034, '2014-11': -9.833566401532835, '2014-12': -7.141660298569342, '2015-01': -12.07379042838671, '2015-02': 2.7348910003759386, '2015-03': 17.877497952539144, '2015-04': 7.2215293890104615, '2015-05': 13.00615733162247, '2015-06': 14.769503634037173, '2015-07': 15.438913371232022, '2015-08': 12.742797399831595, '2015-09': 16.6939478141513, '2015-10': 13.257381320987394, '2015-11': 24.076323284176503, '2015-12': 25.293243618807338, '2016-01': 28.840792920526702, '2016-02': 33.623637305474844, '2016-03': 44.87557321646764, '2016-04': 51.27018885966963, '2016-05': 56.84739851755314, '2016-06': 61.03579680415137, '2016-07': 65.87831482221462, '2016-08': 70.99956488224831, '2016-09': 78.01718199125798, '2016-10': 80.29471034463909, '2016-11': 90.15612694601751, '2016-12': 108.24536883130938, '2017-01': 115.71455236699042, '2017-02': 123.45800285259773, '2017-03': 106.01519297146824, '2017-04': 104.38106885787653, '2017-05': 109.18565519762397, '2017-06': 93.62724135598287, '2017-07': 92.18573716805759, '2017-08': 90.92615395330206, '2017-09': 100.26484766661845, '2017-10': 107.2897003052557, '2017-11': 109.30835579983919, '2017-12': 102.84615843980424, '2018-01': 106.49974096875124, '2018-02': 112.00215402925515, '2018-03': 110.72444590872558, '2018-04': 109.85431551776519, '2018-05': 107.57047969217184, '2018-06': 104.4593777123192, '2018-07': 100.27234279397703, '2018-08': 100.82149054949396, '2018-09': 96.55650219445042, '2018-10': 104.61514322625614, '2018-11': 91.19405482652596, '2018-12': 95.4280026103949, '2019-01': 87.10496103574312, '2019-02': 98.87494885710224, '2019-03': 93.8080116258496, '2019-04': 89.15570624603413, '2019-05': 93.45676244031422, '2019-06': 99.35103274461045, '2019-07': 114.25556700962849, '2019-08': 116.81633914945179, '2019-09': 118.39950498892793, '2019-10': 117.78652154864035, '2019-11': 121.31769648574729, '2019-12': 127.6758525670449, '2020-01': 133.84324928275964, '2020-02': 149.59647326907833, '2020-03': 142.7778659356679, '2020-04': 118.59328391636011, '2020-05': 134.1464863920046, '2020-06': 140.1578312313345, '2020-07': 156.298890461263, '2020-08': 183.37708624966788, '2020-09': 188.62875771622396, '2020-10': 176.98609579749007, '2020-11': 159.5630484837296, '2020-12': 183.5949541658354, '2021-01': 194.6284882748209, '2021-02': 199.4218603230385, '2021-03': 210.4064437957073, '2021-04': 238.2673259301664, '2021-05': 228.93759489868404, '2021-06': 242.3918023830385, '2021-07': 240.67565820520852, '2021-08': 239.1649124980907, '2021-09': 270.84555705237017, '2021-10': 275.3428057354221, '2021-11': 277.50724135066275, '2021-12': 241.27085781227117, '2022-01': 244.83516477432508, '2022-02': 228.2707350150629, '2022-03': 128.91091223401355, '2022-04': 171.84775649258205, '2022-05': 150.05303285804126, '2022-06': 137.02921409626737, '2022-07': 133.7376581347931, '2022-08': 126.85485445956334, '2022-09': 146.8432717150072, '2022-10': 89.76847713598839, '2022-11': 108.64875607259457, '2022-12': 110.37926099839015}
curs_above_median_avg_bc = {'2013-01': 10.750541559067717, '2013-02': 10.834502688998327, '2013-03': 4.494322922109495, '2013-04': -0.5714862258602404, '2013-05': -5.742702402121536, '2013-06': -12.24269598588662, '2013-07': -13.940218574237484, '2013-08': -6.500192940513571, '2013-09': -4.228088891449899, '2013-10': 0.17937698843826233, '2013-11': 3.010956787319463, '2013-12': -2.3706870595497698, '2014-01': -0.35462235419141397, '2014-02': -4.337317758716475, '2014-03': -3.380690936303643, '2014-04': -5.1471537318867, '2014-05': -5.894779438101638, '2014-06': 3.2294966102992317, '2014-07': 6.991292468334764, '2014-08': 3.7322423379703817, '2014-09': 4.567344067442969, '2014-10': -0.08058537943080868, '2014-11': 9.45530394673062, '2014-12': 13.534916524334161, '2015-01': 1.0230798294911025, '2015-02': 20.61275234912181, '2015-03': 34.65424427168517, '2015-04': 30.670506808917985, '2015-05': 36.198034412278886, '2015-06': 31.577122517296317, '2015-07': 33.321942593897404, '2015-08': 39.913226756345786, '2015-09': 47.44881703888666, '2015-10': 40.458860912142484, '2015-11': 44.57183898336305, '2015-12': 46.08925563732027, '2016-01': 42.94589589624258, '2016-02': 42.649883649502506, '2016-03': 51.57750783287547, '2016-04': 61.140910114403525, '2016-05': 69.65450933150439, '2016-06': 70.48027468446745, '2016-07': 69.13626423981252, '2016-08': 86.68635277679417, '2016-09': 87.26479954832351, '2016-10': 85.33525252600533, '2016-11': 90.04337971724567, '2016-12': 107.39915313903086, '2017-01': 123.45963398483062, '2017-02': 136.46259356486357, '2017-03': 118.48638785681888, '2017-04': 111.21233749602001, '2017-05': 108.62263081274786, '2017-06': 97.43054603118931, '2017-07': 99.47654753439433, '2017-08': 106.09581415525699, '2017-09': 120.92695248853076, '2017-10': 121.42067987699411, '2017-11': 124.5662586516434, '2017-12': 123.53278802606762, '2018-01': 121.17868771779898, '2018-02': 136.2956033958729, '2018-03': 138.53567996968818, '2018-04': 140.5887368246108, '2018-05': 147.86156297018832, '2018-06': 146.46246701633783, '2018-07': 153.4926366801963, '2018-08': 150.0572708028755, '2018-09': 153.75428026330283, '2018-10': 163.58457650503922, '2018-11': 148.58470839953623, '2018-12': 148.12936460875255, '2019-01': 146.03516498934138, '2019-02': 154.12471022361441, '2019-03': 153.32167255109374, '2019-04': 156.5629537421136, '2019-05': 156.77678171629427, '2019-06': 156.0572719423492, '2019-07': 164.59922319357455, '2019-08': 155.231748683928, '2019-09': 152.44767295473878, '2019-10': 146.4351602724923, '2019-11': 147.42103188367062, '2019-12': 159.46884976075623, '2020-01': 171.5202771066377, '2020-02': 186.2705451386358, '2020-03': 174.96295628676614, '2020-04': 140.12950641729768, '2020-05': 155.88289200287227, '2020-06': 165.84168453535688, '2020-07': 168.3657946369527, '2020-08': 184.27992467256237, '2020-09': 194.56345671874794, '2020-10': 200.11018538673113, '2020-11': 191.4033895471433, '2020-12': 220.17957784922763, '2021-01': 243.7757381492792, '2021-02': 246.69754709331588, '2021-03': 249.29323273617973, '2021-04': 259.87357496617176, '2021-05': 272.1260099175431, '2021-06': 286.08299585825046, '2021-07': 275.90451039004773, '2021-08': 277.7088038073994, '2021-09': 276.7853468555648, '2021-10': 265.31353217699444, '2021-11': 282.46985528845545, '2021-12': 273.99078211201265, '2022-01': 268.2636213792347, '2022-02': 251.7246582569903, '2022-03': 161.59034292623505, '2022-04': 205.7749611647753, '2022-05': 170.14177570879176, '2022-06': 170.06986337956644, '2022-07': 180.189126708466, '2022-08': 180.91576747202978, '2022-09': 199.5450122785594, '2022-10': 140.58073259302807, '2022-11': 180.2669228459197, '2022-12': 179.43043781834547}
curs_mixed_avg_bc = {'2013-01': 3.518220760661328, '2013-02': 10.390810859801846, '2013-03': 4.686651324436708, '2013-04': -4.655967345002843, '2013-05': -9.504584371684565, '2013-06': -10.371746476569943, '2013-07': -9.869053388935356, '2013-08': -7.1489920034012115, '2013-09': -10.125409640139216, '2013-10': -9.421922632223033, '2013-11': -9.941531567929795, '2013-12': -13.485546145448158, '2014-01': -6.702440494762896, '2014-02': -9.239094787417967, '2014-03': -16.973936614587835, '2014-04': -19.412185305482954, '2014-05': -25.06410271696301, '2014-06': -13.840102247910135, '2014-07': -14.506987036417007, '2014-08': -20.022545490558375, '2014-09': -17.553813340461353, '2014-10': -18.567190430068802, '2014-11': -17.883339924500984, '2014-12': -13.85507995353108, '2015-01': -13.531466424710981, '2015-02': -0.7443227719872381, '2015-03': 13.554877389297548, '2015-04': 4.380473736938684, '2015-05': 12.130749529687623, '2015-06': 14.083061926239338, '2015-07': 14.12360339028147, '2015-08': 13.421151807268483, '2015-09': 17.28187583955485, '2015-10': 16.397843798970424, '2015-11': 24.397244472423484, '2015-12': 26.316944619177953, '2016-01': 29.99065354189232, '2016-02': 31.188833221218992, '2016-03': 41.61970234399344, '2016-04': 50.804283704653905, '2016-05': 60.197211230861015, '2016-06': 67.16029463676165, '2016-07': 71.84445877194217, '2016-08': 77.80523595096214, '2016-09': 84.67500822891563, '2016-10': 90.36536460636415, '2016-11': 96.80453587276658, '2016-12': 111.70437557655654, '2017-01': 123.51009296276878, '2017-02': 136.30619631785456, '2017-03': 115.42589274020516, '2017-04': 113.47527262460844, '2017-05': 127.69754341815722, '2017-06': 114.07565935863451, '2017-07': 117.76559113517978, '2017-08': 118.93130650534908, '2017-09': 130.62486142377224, '2017-10': 134.5537897189165, '2017-11': 130.80753821402104, '2017-12': 123.28607220443169, '2018-01': 129.72340980024256, '2018-02': 138.14257711985593, '2018-03': 138.00207945527058, '2018-04': 134.24922168662675, '2018-05': 131.21711616386182, '2018-06': 127.11448790912057, '2018-07': 124.33913579127731, '2018-08': 122.5490891300924, '2018-09': 116.49507533449083, '2018-10': 125.02957329490845, '2018-11': 112.75611052022008, '2018-12': 120.77734737899846, '2019-01': 112.24368117801902, '2019-02': 125.60275234994532, '2019-03': 125.76240502701621, '2019-04': 123.5455601264114, '2019-05': 129.52500783501253, '2019-06': 132.08530781471595, '2019-07': 146.58411592680255, '2019-08': 150.986103532472, '2019-09': 154.66476857586193, '2019-10': 156.76883494481464, '2019-11': 159.13119563407622, '2019-12': 164.66783453336896, '2020-01': 176.6670257795091, '2020-02': 197.46626786911864, '2020-03': 185.73176905357752, '2020-04': 151.90795387639474, '2020-05': 170.19512485429377, '2020-06': 176.9112952755379, '2020-07': 187.38915603734813, '2020-08': 212.33528706567785, '2020-09': 219.2744060904397, '2020-10': 212.06504673919832, '2020-11': 192.680943220462, '2020-12': 230.47066292669675, '2021-01': 238.50414972195586, '2021-02': 241.1260148849831, '2021-03': 257.04500544138904, '2021-04': 286.4470677680454, '2021-05': 284.91470095540325, '2021-06': 297.3975171294248, '2021-07': 292.4624870362228, '2021-08': 291.6101284272876, '2021-09': 322.5555409987651, '2021-10': 334.02207201678954, '2021-11': 341.4756914130155, '2021-12': 306.7962058123743, '2022-01': 305.8835923540485, '2022-02': 282.2569663447362, '2022-03': 172.1604255209867, '2022-04': 208.83289968691062, '2022-05': 185.4258950684993, '2022-06': 170.03978545873005, '2022-07': 164.53391325226022, '2022-08': 158.64868150099048, '2022-09': 173.4080461544178, '2022-10': 116.92382673575969, '2022-11': 148.6000804549609, '2022-12': 151.71404308416666}


div_no_dividend_avg_bc = calculate_difference(cum_no_dividend_avg_bc, curs_no_dividend_avg_bc)
div_below_median_avg_bc = calculate_difference(cum_below_median_avg_bc, curs_below_median_avg_bc)
div_above_median_avg_bc = calculate_difference(cum_above_median_avg_bc, curs_above_median_avg_bc)
div_mixed_avg_bc = calculate_difference(cum_mixed_avg_bc, curs_mixed_avg_bc)












cum_no_dividend_avg_all = {'2013-01': 3.578914344423234, '2013-02': 6.123278416742606, '2013-03': 0.689782048280696, '2013-04': -5.959414006791186, '2013-05': -14.483074060562796, '2013-06': -16.033375128761417, '2013-07': -16.861149786048692, '2013-08': -14.586919242558826, '2013-09': -15.64583929640393, '2013-10': -18.13893941933049, '2013-11': -19.65559875595837, '2013-12': -25.509327268866677, '2014-01': -20.813697011918574, '2014-02': -21.743373534730782, '2014-03': -25.746708357372338, '2014-04': -24.59046339044304, '2014-05': -27.196412600603935, '2014-06': -20.022144341115155, '2014-07': -19.117611134647618, '2014-08': -21.44010592343869, '2014-09': -21.214010820355146, '2014-10': -20.1969508338248, '2014-11': -16.700163250413357, '2014-12': -16.013097214500593, '2015-01': -19.274060353789157, '2015-02': -12.856296207109907, '2015-03': -0.31364428279114787, '2015-04': -6.909095471474769, '2015-05': -1.1265007967837692, '2015-06': -4.027343185285581, '2015-07': -3.483410784640162, '2015-08': -1.699070358025656, '2015-09': 2.9317845119134045, '2015-10': 8.288297217310081, '2015-11': 20.325572025025586, '2015-12': 31.016473517210063, '2016-01': 31.000924854306945, '2016-02': 33.93078178114672, '2016-03': 48.45593682301184, '2016-04': 63.05927233008364, '2016-05': 62.77857975556829, '2016-06': 63.365826016895866, '2016-07': 57.64430171841326, '2016-08': 75.99313006175863, '2016-09': 84.9449864683836, '2016-10': 88.97869135002252, '2016-11': 95.19606033422454, '2016-12': 106.13685908530046, '2017-01': 112.10721542157671, '2017-02': 120.36130433483491, '2017-03': 112.56147325197384, '2017-04': 109.13136957487501, '2017-05': 104.20452209350151, '2017-06': 90.8374161259613, '2017-07': 91.01262548964839, '2017-08': 95.6857537052737, '2017-09': 104.82456891584349, '2017-10': 115.37192525891467, '2017-11': 111.94722090262017, '2017-12': 114.62378544383434, '2018-01': 126.07277359474023, '2018-02': 134.89588484508457, '2018-03': 129.85102567497137, '2018-04': 123.02047051629242, '2018-05': 120.92525456466801, '2018-06': 116.61799403566926, '2018-07': 112.01000367746148, '2018-08': 112.3105381115145, '2018-09': 105.42173422103893, '2018-10': 118.2932107805358, '2018-11': 119.82039415420532, '2018-12': 121.17479129772013, '2019-01': 118.09220615844751, '2019-02': 134.000956488791, '2019-03': 155.94828656727194, '2019-04': 155.8377466602769, '2019-05': 154.4502027680782, '2019-06': 150.3065736599189, '2019-07': 159.14484886714666, '2019-08': 162.467349827537, '2019-09': 159.4788895545957, '2019-10': 169.77969004245844, '2019-11': 173.17520158348714, '2019-12': 174.26514974312286, '2020-01': 185.8608641270407, '2020-02': 206.02391763053413, '2020-03': 187.71310703780918, '2020-04': 158.32929068132944, '2020-05': 189.75333111504455, '2020-06': 195.50343410914164, '2020-07': 190.0672048555575, '2020-08': 206.18363030937448, '2020-09': 220.26159833318513, '2020-10': 214.60708293991345, '2020-11': 193.14064446122697, '2020-12': 220.18941700743952, '2021-01': 230.53121940640816, '2021-02': 253.69500388913283, '2021-03': 261.97619274861455, '2021-04': 265.60363325713104, '2021-05': 276.600608965803, '2021-06': 289.3193827467654, '2021-07': 290.64321650106564, '2021-08': 289.6615600326453, '2021-09': 324.24700559163375, '2021-10': 340.6065377000635, '2021-11': 367.4094783349863, '2021-12': 348.2653897468334, '2022-01': 333.0043977206902, '2022-02': 319.864938354819, '2022-03': 235.6301248457023, '2022-04': 283.8292890966421, '2022-05': 279.1701282368109, '2022-06': 261.0687677001673, '2022-07': 253.61380427937456, '2022-08': 257.4657918898693, '2022-09': 277.3217640983069, '2022-10': 222.2811484888645, '2022-11': 263.21843192266164, '2022-12': 272.28296469752553}
cum_below_median_avg_all = {'2013-01': 6.698452475405414, '2013-02': 9.811809475438583, '2013-03': 7.095424021337848, '2013-04': -1.9898272831914587, '2013-05': -11.537141184600175, '2013-06': -11.805149306749241, '2013-07': -10.695759981709053, '2013-08': -6.2781086123213985, '2013-09': -6.930375179140591, '2013-10': -9.981835671545348, '2013-11': -11.148838380462267, '2013-12': -15.65257806688949, '2014-01': -7.720815370958678, '2014-02': -8.896000067828137, '2014-03': -16.786174440856307, '2014-04': -17.05160706512423, '2014-05': -20.781249538597102, '2014-06': -12.772809901361926, '2014-07': -13.181540117026646, '2014-08': -13.748494894843155, '2014-09': -11.609285236940304, '2014-10': -12.315479035016196, '2014-11': -12.435006259800518, '2014-12': -11.271654348064896, '2015-01': -14.899970132433992, '2015-02': -8.237758957535146, '2015-03': 5.445932612287097, '2015-04': 0.5686576564847501, '2015-05': 7.121979112270815, '2015-06': 5.875553901528363, '2015-07': 8.592917507103714, '2015-08': 10.237501498630364, '2015-09': 14.776708842899877, '2015-10': 21.86499771945538, '2015-11': 25.362102843631362, '2015-12': 26.5962957512587, '2016-01': 31.9517689995779, '2016-02': 34.93238892895989, '2016-03': 42.648899543106424, '2016-04': 47.72990831359889, '2016-05': 54.99561750880555, '2016-06': 53.91350257620482, '2016-07': 53.304710728152614, '2016-08': 59.53522345272071, '2016-09': 68.794280117046, '2016-10': 87.95974105800146, '2016-11': 92.12085893171114, '2016-12': 104.54254763733614, '2017-01': 107.69402288499666, '2017-02': 112.37825734586404, '2017-03': 99.5203584995261, '2017-04': 98.10136258727826, '2017-05': 92.43823797288738, '2017-06': 94.86576394377992, '2017-07': 97.19717503459965, '2017-08': 102.17883471471976, '2017-09': 107.4066836868877, '2017-10': 115.59751506120217, '2017-11': 119.60333244732007, '2017-12': 113.63270320869678, '2018-01': 116.80609394410001, '2018-02': 117.85446309799723, '2018-03': 117.04762571203614, '2018-04': 116.27124029865374, '2018-05': 108.3845759984305, '2018-06': 107.0855448488358, '2018-07': 108.48179677122398, '2018-08': 109.67633893299444, '2018-09': 112.27683078965356, '2018-10': 124.13161005769679, '2018-11': 113.51482910679795, '2018-12': 116.4154320511257, '2019-01': 108.13938084068835, '2019-02': 145.81282854140287, '2019-03': 143.86142776091847, '2019-04': 154.74300102833527, '2019-05': 156.60043012131283, '2019-06': 154.3695630586592, '2019-07': 162.34829217641297, '2019-08': 165.1415635039087, '2019-09': 163.4814721320891, '2019-10': 187.64720355293804, '2019-11': 186.2750201871405, '2019-12': 198.53312996119087, '2020-01': 212.28012309418952, '2020-02': 230.93720525345583, '2020-03': 214.83574332691302, '2020-04': 198.56578477600914, '2020-05': 213.00029902254516, '2020-06': 227.9071765757779, '2020-07': 238.00075992437212, '2020-08': 265.528598807754, '2020-09': 297.49392467757855, '2020-10': 280.257151133132, '2020-11': 265.20443130267375, '2020-12': 294.5643553807013, '2021-01': 308.54717024248873, '2021-02': 325.8681398543562, '2021-03': 330.9508597490674, '2021-04': 359.5076969155334, '2021-05': 357.4037415380294, '2021-06': 366.69954599894317, '2021-07': 374.04207817531614, '2021-08': 362.3067509040796, '2021-09': 390.536580160271, '2021-10': 415.21374408379154, '2021-11': 489.298235853737, '2021-12': 443.05506685892453, '2022-01': 432.7153846250525, '2022-02': 409.5476383677608, '2022-03': 270.0685171295516, '2022-04': 351.4362755846059, '2022-05': 338.4238048552575, '2022-06': 330.16796508864337, '2022-07': 318.6078883420701, '2022-08': 321.45208112078257, '2022-09': 346.387219135919, '2022-10': 267.4779537194095, '2022-11': 310.6752795895646, '2022-12': 322.82895935818505}
cum_above_median_avg_all = {'2013-01': 5.79128436062033, '2013-02': 8.434721530931611, '2013-03': 9.7594357098016, '2013-04': 4.064500234644064, '2013-05': -1.4924504189822718, '2013-06': -4.788649453868388, '2013-07': -3.0820588715646524, '2013-08': -0.2832150324592053, '2013-09': 0.10027921364925696, '2013-10': 2.934717516881169, '2013-11': 2.284524914473973, '2013-12': 0.5509071320372483, '2014-01': 4.588727667718939, '2014-02': 0.19587481360345826, '2014-03': 1.197833561739503, '2014-04': -0.45036612691340405, '2014-05': 0.5867982492369972, '2014-06': 8.332098808194054, '2014-07': 9.176771519897464, '2014-08': 8.318342262440392, '2014-09': 9.012055590137248, '2014-10': 4.842375379244168, '2014-11': 8.045116889206883, '2014-12': 13.48033847803709, '2015-01': 10.798037178926535, '2015-02': 23.685648651856962, '2015-03': 33.6086190623083, '2015-04': 28.260408968382265, '2015-05': 31.897583549664855, '2015-06': 31.41556312155249, '2015-07': 34.47914523497244, '2015-08': 36.95121255420517, '2015-09': 44.97002016881162, '2015-10': 42.28782224077787, '2015-11': 49.95687378475431, '2015-12': 50.964864049602944, '2016-01': 56.1300688473449, '2016-02': 59.39485599788779, '2016-03': 69.03546743626907, '2016-04': 75.79009986228513, '2016-05': 84.42650616489146, '2016-06': 93.49239434739796, '2016-07': 90.53351247185084, '2016-08': 103.83565092814018, '2016-09': 126.40286202837005, '2016-10': 120.99889872634608, '2016-11': 131.88395901334772, '2016-12': 153.99114110079358, '2017-01': 162.6404473385223, '2017-02': 175.6230928928501, '2017-03': 159.93941384365843, '2017-04': 157.87102201347088, '2017-05': 155.4499361379873, '2017-06': 147.04880841424367, '2017-07': 150.7030554350998, '2017-08': 162.83988262256153, '2017-09': 177.95017540942771, '2017-10': 190.9058033699956, '2017-11': 198.82524400264367, '2017-12': 192.6812302002939, '2018-01': 194.30339480748606, '2018-02': 210.15173670639712, '2018-03': 213.73551869419884, '2018-04': 221.67670888607844, '2018-05': 221.05583586311144, '2018-06': 216.25369052078068, '2018-07': 217.84562494908158, '2018-08': 212.72475902687754, '2018-09': 210.19762442120893, '2018-10': 220.44788873230522, '2018-11': 209.05238313868813, '2018-12': 211.77714075341484, '2019-01': 209.40674977111442, '2019-02': 221.83510651331036, '2019-03': 225.02008029206758, '2019-04': 240.5470539419274, '2019-05': 246.5065532368896, '2019-06': 244.50439308688533, '2019-07': 253.62040876006398, '2019-08': 252.27589606860099, '2019-09': 250.86052577173047, '2019-10': 256.68213379935196, '2019-11': 256.5401965810995, '2019-12': 264.3098493286187, '2020-01': 285.01599380642944, '2020-02': 317.8833951285951, '2020-03': 303.27032989391427, '2020-04': 261.1533856099203, '2020-05': 293.2012079019268, '2020-06': 325.55183524862696, '2020-07': 332.3927765090251, '2020-08': 344.1351955295227, '2020-09': 345.7031505006734, '2020-10': 348.0000353619828, '2020-11': 331.11332730153543, '2020-12': 372.2792910598253, '2021-01': 393.7952129667508, '2021-02': 399.481703127882, '2021-03': 409.5552157667424, '2021-04': 428.8703708762812, '2021-05': 442.54934574011895, '2021-06': 463.2480705845746, '2021-07': 445.8974633934755, '2021-08': 449.55668823953897, '2021-09': 469.12753470265585, '2021-10': 460.2765584333069, '2021-11': 492.31897676336655, '2021-12': 470.27769548609274, '2022-01': 461.7843323300339, '2022-02': 438.3362432920327, '2022-03': 312.98282535569103, '2022-04': 372.6270602607495, '2022-05': 360.7783820063057, '2022-06': 368.69321748211155, '2022-07': 352.4252041814473, '2022-08': 355.2951844383655, '2022-09': 386.8188880632305, '2022-10': 298.48856828538044, '2022-11': 377.6612222491598, '2022-12': 379.70113763722935}
cum_mixed_avg_all = {'2013-01': 4.833161634199601, '2013-02': 7.602923219620461, '2013-03': 3.2386445739151837, '2013-04': -4.35893463360496, '2013-05': -13.288016460574504, '2013-06': -14.33349617709252, '2013-07': -14.405098927926662, '2013-08': -11.302523688948263, '2013-09': -12.208048830167439, '2013-10': -14.916634109657323, '2013-11': -16.30250050869899, '2013-12': -21.654302238577138, '2014-01': -15.803968352089159, '2014-02': -16.822712532604623, '2014-03': -22.182355383346287, '2014-04': -21.51730679546481, '2014-05': -24.535115174039312, '2014-06': -17.02594166643091, '2014-07': -16.584714888476327, '2014-08': -18.28575303087253, '2014-09': -17.378195392466655, '2014-10': -16.958350970831436, '2014-11': -14.726050770644061, '2014-12': -13.86154437407151, '2015-01': -17.266423295072364, '2015-02': -10.722929820845927, '2015-03': 2.2860336878073317, '2015-04': -3.7831874257587383, '2015-05': 2.294991379558442, '2015-06': -0.08471345021938692, '2015-07': 1.1675665722125528, '2015-08': 2.9238807387861554, '2015-09': 7.565122962502402, '2015-10': 13.522531544559913, '2015-11': 22.936343615536202, '2015-12': 30.53193723336669, '2016-01': 32.46123194875885, '2016-02': 35.43350694084244, '2016-03': 47.67809810469834, '2016-04': 58.940383001945705, '2016-05': 61.50506572922605, '2016-06': 61.48119467589388, '2016-07': 57.58529028566941, '2016-08': 71.72375738209207, '2016-09': 80.88333730878281, '2016-10': 90.65873171148615, '2016-11': 96.20760337528039, '2016-12': 107.79658226699395, '2017-01': 112.89083339011813, '2017-02': 120.0324671753918, '2017-03': 110.42918406445699, '2017-04': 107.65206909029637, '2017-05': 102.41483288190469, '2017-06': 94.33844469951076, '2017-07': 95.21962365217631, '2017-08': 100.04658840284878, '2017-09': 108.02305694534367, '2017-10': 117.91639771409854, '2017-11': 116.91154424054267, '2017-12': 116.82156900445509, '2018-01': 125.67365573453495, '2018-02': 131.97004091523291, '2018-03': 128.32321430761846, '2018-04': 123.47379817722239, '2018-05': 119.40518812754365, '2018-06': 116.06920871622006, '2018-07': 113.43664159960029, '2018-08': 114.03591482961693, '2018-09': 110.20868012418403, '2018-10': 122.9141120385974, '2018-11': 120.53428844100785, '2018-12': 122.42219158812189, '2019-01': 117.57596093409202, '2019-02': 141.01891371763102, '2019-03': 155.72304853034242, '2019-04': 159.31972268281874, '2019-05': 158.97312998631003, '2019-06': 155.38744867712006, '2019-07': 164.0792125922156, '2019-08': 167.27831890130287, '2019-09': 164.6747089837548, '2019-10': 179.61794993069455, '2019-11': 181.57509178368022, '2019-12': 186.2233473308402, '2020-01': 198.73173840667474, '2020-02': 218.60130895651895, '2020-03': 200.87318918061143, '2020-04': 175.8250078002003, '2020-05': 201.8246915584418, '2020-06': 210.95278706900942, '2020-07': 210.95491987222252, '2020-08': 231.24842722550358, '2020-09': 251.62380853006675, '2020-10': 242.04603958522898, '2020-11': 222.38026281230808, '2020-12': 250.70570222304926, '2021-01': 262.4304167972003, '2021-02': 284.3584078344117, '2021-03': 291.8374853367999, '2021-04': 303.4335388999767, '2021-05': 310.7263501378911, '2021-06': 322.69172559206237, '2021-07': 325.95273576205574, '2021-08': 321.60378071410724, '2021-09': 354.97899060030437, '2021-10': 374.3898926823439, '2021-11': 416.93302028382044, '2021-12': 389.0388507447425, '2022-01': 374.0121886216893, '2022-02': 358.2583068995503, '2022-03': 258.93454698998244, '2022-04': 316.5184026039125, '2022-05': 309.93178066994244, '2022-06': 292.9776767579042, '2022-07': 284.3271055911804, '2022-08': 288.16886477368195, '2022-09': 310.04262684596904, '2022-10': 247.4365832233612, '2022-11': 290.8442734962838, '2022-12': 300.99882537685903}

print("cum_no_dividend_avg_all: ", cum_no_dividend_avg_all)
print("cum_below_median_avg_all: ", cum_below_median_avg_all)
print("cum_above_median_avg_all: ", cum_above_median_avg_all)
print("cum_mixed_avg_all: ", cum_mixed_avg_all)



cusr_no_dividend_avg_all = {'2013-01': 3.4726251703431466, '2013-02': 5.9081981986900844, '2013-03': 0.37964014836497917, '2013-04': -6.355037020811083, '2013-05': -14.948680578208872, '2013-06': -16.596251328668853, '2013-07': -17.524053597175048, '2013-08': -15.373398208896615, '2013-09': -16.52787825411326, '2013-10': -19.100087355062133, '2013-11': -20.703980485839757, '2013-12': -26.586228302668445, '2014-01': -22.048615337845558, '2014-02': -23.053822598802288, '2014-03': -27.08004336191303, '2014-04': -26.034373764397856, '2014-05': -28.680129588223114, '2014-06': -21.74166248984265, '2014-07': -20.94606579057372, '2014-08': -23.305445397240476, '2014-09': -23.17400259495611, '2014-10': -22.271424650971085, '2014-11': -18.954613795436515, '2014-12': -18.375122928521716, '2015-01': -21.608286668776344, '2015-02': -15.439954029699765, '2015-03': -3.332980538455532, '2015-04': -9.792435055237526, '2015-05': -4.25266427425427, '2015-06': -7.1254696848427335, '2015-07': -6.662727564566707, '2015-08': -5.000758742514377, '2015-09': -0.588994761706596, '2015-10': 4.520787381158864, '2015-11': 16.075795012902617, '2015-12': 26.32566680767756, '2016-01': 26.282956954586247, '2016-02': 29.07958396497319, '2016-03': 43.05090764897563, '2016-04': 57.094859962171164, '2016-05': 56.79673901012474, '2016-06': 57.33471424127161, '2016-07': 51.796730364682844, '2016-08': 69.43725653262005, '2016-09': 78.02797343562145, '2016-10': 81.88314424927992, '2016-11': 87.83940310129441, '2016-12': 98.34019528657632, '2017-01': 104.03323725095288, '2017-02': 111.92164366107428, '2017-03': 104.36906628406378, '2017-04': 101.01970285827933, '2017-05': 96.23250767201155, '2017-06': 83.33581107050705, '2017-07': 83.45271364256479, '2017-08': 87.8894833437579, '2017-09': 96.6128101147905, '2017-10': 106.68592772927545, '2017-11': 103.34797761744557, '2017-12': 105.86459518782591, '2018-01': 116.76291871365119, '2018-02': 125.13930895349974, '2018-03': 120.22064430149095, '2018-04': 113.59296227239253, '2018-05': 111.50303171285158, '2018-06': 107.29622050867506, '2018-07': 102.8033096408811, '2018-08': 103.00761002192984, '2018-09': 96.33750760733028, '2018-10': 108.55666370260492, '2018-11': 109.93264927107877, '2018-12': 111.14307637957373, '2019-01': 108.13824696761576, '2019-02': 123.26456811849833, '2019-03': 144.1485921205305, '2019-04': 143.98683854084408, '2019-05': 142.60727163724377, '2019-06': 138.5945179535307, '2019-07': 146.96297371099, '2019-08': 150.0730343414953, '2019-09': 147.16375781690272, '2019-10': 156.9137491055953, '2019-11': 160.0854190238338, '2019-12': 161.06124686391576, '2020-01': 172.0930750372008, '2020-02': 191.2793889165856, '2020-03': 173.8451755338538, '2020-04': 145.87204017918415, '2020-05': 175.77510379265476, '2020-06': 181.2421763506272, '2020-07': 176.06266943730563, '2020-08': 191.39535403815492, '2020-09': 204.7877395994967, '2020-10': 199.40079495027953, '2020-11': 178.96628556389382, '2020-12': 204.70152252297754, '2021-01': 214.54090615103715, '2021-02': 236.58190686543637, '2021-03': 244.46024557997202, '2021-04': 247.9099800416078, '2021-05': 258.37257413160864, '2021-06': 270.4735651843242, '2021-07': 271.7311410309749, '2021-08': 270.79483420091486, '2021-09': 303.70353850869446, '2021-10': 319.26871210901584, '2021-11': 344.7714569715834, '2021-12': 326.5523982173232, '2022-01': 311.98679465358816, '2022-02': 299.4412957521674, '2022-03': 219.2601358258276, '2022-04': 265.0646340054405, '2022-05': 260.5894505484389, '2022-06': 243.33132627537904, '2022-07': 236.19879780188876, '2022-08': 239.8172970268468, '2022-09': 258.6491796725878, '2022-10': 206.28859592453367, '2022-11': 245.15068324637136, '2022-12': 253.7205542541784}
curs_below_median_avg_all = {'2013-01': 6.5764588633612675, '2013-02': 9.564402077803514, '2013-03': 6.73241791564585, '2013-04': -2.443618514179835, '2013-05': -12.068038168908812, '2013-06': -12.455580970380142, '2013-07': -11.475467240756354, '2013-08': -7.217314483568482, '2013-09': -7.983697730664452, '2013-10': -11.121236027126857, '2013-11': -12.393799341220502, '2013-12': -16.954717984863443, '2014-01': -9.28842948389319, '2014-02': -10.586450412140735, '2014-03': -18.47279350288482, '2014-04': -18.875169572940653, '2014-05': -22.66489257502451, '2014-06': -14.988686605240165, '2014-07': -15.528611053302788, '2014-08': -16.215392745553547, '2014-09': -14.278479973824087, '2014-10': -15.104229331242259, '2014-11': -15.360602645483057, '2014-12': -14.37653323116207, '2015-01': -18.039994884788722, '2015-02': -11.785397267891218, '2015-03': 1.2077707331316745, '2015-04': -3.634711488858555, '2015-05': 2.483738223743681, '2015-06': 1.1305650004436174, '2015-07': 3.5656838596488605, '2015-08': 4.973919627564549, '2015-09': 9.13642127632781, '2015-10': 15.716646683476876, '2015-11': 18.877800465495476, '2015-12': 19.888854144240888, '2016-01': 24.644815191256363, '2016-02': 27.145414799955915, '2016-03': 34.10241673175805, '2016-04': 38.56555548997926, '2016-05': 45.0677944448407, '2016-06': 43.742918714422665, '2016-07': 42.86295907899176, '2016-08': 48.358385361492815, '2016-09': 56.658694108808724, '2016-10': 74.13678297459008, '2016-11': 77.68297487742682, '2016-12': 88.8628011612234, '2017-01': 91.57138240874927, '2017-02': 95.69089626633378, '2017-03': 83.64239943014513, '2017-04': 82.13565602959807, '2017-05': 76.7284918978099, '2017-06': 78.75762200129324, '2017-07': 80.69631208596992, '2017-08': 85.0613425485693, '2017-09': 89.6470115673839, '2017-10': 96.93713045753982, '2017-11': 100.39708435138101, '2017-12': 94.74968481307133, '2018-01': 97.40529406538654, '2018-02': 98.12285011335528, '2018-03': 97.15237289186594, '2018-04': 96.21072015751295, '2018-05': 88.81944502337045, '2018-06': 87.40652563975142, '2018-07': 88.43453668745747, '2018-08': 89.27895056102236, '2018-09': 91.3914945900069, '2018-10': 101.84523164177502, '2018-11': 92.04971288865822, '2018-12': 94.42458719915452, '2019-01': 86.62294081132629, '2019-02': 120.03605059898695, '2019-03': 117.9240481091047, '2019-04': 127.28362362000149, '2019-05': 128.57679864120612, '2019-06': 126.2261088174633, '2019-07': 132.9591958171116, '2019-08': 135.07724495639707, '2019-09': 133.24363738977647, '2019-10': 154.27485194462324, '2019-11': 152.70118612448408, '2019-12': 163.16151938054938, '2020-01': 175.05904257351074, '2020-02': 191.2718778569161, '2020-03': 176.87998011511633, '2020-04': 162.3571890886963, '2020-05': 174.8211931762403, '2020-06': 187.68997467252038, '2020-07': 196.32597961279933, '2020-08': 220.2402374213957, '2020-09': 248.0258083315751, '2020-10': 232.71498289736036, '2020-11': 219.32522589715848, '2020-12': 244.7779036144789, '2021-01': 256.66080999249044, '2021-02': 271.446749463615, '2021-03': 275.5450242950213, '2021-04': 300.0957799815767, '2021-05': 297.92950513579325, '2021-06': 305.682547134343, '2021-07': 311.73131142093735, '2021-08': 301.2050179871052, '2021-09': 325.37054637087806, '2021-10': 346.43645122215486, '2021-11': 410.29846366806845, '2021-12': 369.9220114054084, '2022-01': 360.69642364077737, '2022-02': 340.38259658195216, '2022-03': 219.5581063321424, '2022-04': 289.5422704786553, '2022-05': 278.0363057262053, '2022-06': 270.6402461703281, '2022-07': 260.40272875061004, '2022-08': 262.5745118910354, '2022-09': 283.74944024392295, '2022-10': 215.636321730591, '2022-11': 252.46333530702478, '2022-12': 262.6181979517178}
curs_above_median_avg_all = {'2013-01': 5.311444042695523, '2013-02': 7.46522741179001, '2013-03': 8.302547417032535, '2013-04': 2.2097323092000742, '2013-05': -3.7194634090091827, '2013-06': -7.4031676681164615, '2013-07': -6.180241801039921, '2013-08': -3.9353700354358256, '2013-09': -4.021319195119655, '2013-10': -1.7568352861822456, '2013-11': -2.826036856210723, '2013-12': -4.928901351545701, '2014-01': -1.482008850227512, '2014-02': -5.989367985894267, '2014-03': -5.049261665753213, '2014-04': -6.963121809457307, '2014-05': -6.343819826833896, '2014-06': 0.5025895939025249, '2014-07': 0.9345031372228307, '2014-08': -0.22113618855317263, '2014-09': 0.06928359238589366, '2014-10': -4.1184122157859715, '2014-11': -1.5481331919153907, '2014-12': 3.047074302190711, '2015-01': 0.13268625231774855, '2015-02': 11.308500407523002, '2015-03': 19.764076468666246, '2015-04': 14.497511728062085, '2015-05': 17.273807019073573, '2015-06': 16.376515400388957, '2015-07': 18.623372887537393, '2015-08': 20.338964538449034, '2015-09': 26.921870450852058, '2015-10': 24.112062672794778, '2015-11': 30.341652119246376, '2015-12': 30.759585793236653, '2016-01': 33.8914604592, '2016-02': 35.362526432848675, '2016-03': 42.23381959708057, '2016-04': 46.61374153245412, '2016-05': 52.52476478341743, '2016-06': 58.74107732379172, '2016-07': 55.04249669953041, '2016-08': 64.60604348557051, '2016-09': 81.5788404341439, '2016-10': 76.00213967161822, '2016-11': 83.43701263513003, '2016-12': 99.69971923930481, '2017-01': 105.78271362143022, '2017-02': 115.23980843065394, '2017-03': 102.27946249611377, '2017-04': 99.9597500526671, '2017-05': 97.37475869896134, '2017-06': 90.17849054048543, '2017-07': 92.28904717606206, '2017-08': 100.89805374927306, '2017-09': 111.74989819843955, '2017-10': 120.92463277814613, '2017-11': 126.24591964472253, '2017-12': 120.90326421505404, '2018-01': 121.3659061427093, '2018-02': 132.5274519429307, '2018-03': 134.45767409790182, '2018-04': 139.63802178220953, '2018-05': 138.42367621016632, '2018-06': 134.10803580764247, '2018-07': 134.53940968830253, '2018-08': 130.0160148100159, '2018-09': 127.41496448172293, '2018-10': 134.18986181806835, '2018-11': 125.12425202191544, '2018-12': 126.37392484668464, '2019-01': 123.70473661098238, '2019-02': 131.74648266443162, '2019-03': 133.0996410204564, '2019-04': 143.2988644997503, '2019-05': 146.6236379440977, '2019-06': 144.26922622096973, '2019-07': 149.80702902657796, '2019-08': 147.93478234349445, '2019-09': 146.0196053856499, '2019-10': 149.18604702713384, '2019-11': 148.1746315859987, '2019-12': 152.67388967235775, '2020-01': 166.14689114911232, '2020-02': 187.98169643256747, '2020-03': 177.02873016579917, '2020-04': 147.21660519085415, '2020-05': 168.27742696118477, '2020-06': 189.47626172969265, '2020-07': 193.25866549135787, '2020-08': 200.35416199342632, '2020-09': 200.54854233489414, '2020-10': 201.2338994779703, '2020-11': 189.0183064832267, '2020-12': 215.7574991325698, '2021-01': 229.50188550027005, '2021-02': 232.65686110652797, '2021-03': 238.72755787487634, '2021-04': 250.9302314758027, '2021-05': 259.37092238145135, '2021-06': 272.44640718373836, '2021-07': 260.3396154586015, '2021-08': 262.12238827001556, '2021-09': 274.38678366928485, '2021-10': 267.93391720895875, '2021-11': 288.34680323792924, '2021-12': 273.26733370143813, '2022-01': 267.2938852890733, '2022-02': 251.54978531954404, '2022-03': 169.27694427332943, '2022-04': 207.75408975214432, '2022-05': 199.62665148404758, '2022-06': 204.36183715153732, '2022-07': 193.38667592391454, '2022-08': 194.83738775236156, '2022-09': 214.84149334635393, '2022-10': 157.30612662673872, '2022-11': 208.01967132608348, '2022-12': 208.9270046067821}
curs_mixed_avg_all = {'2013-01': 4.720558304649414, '2013-02': 7.374862455367781, '2013-03': 2.9074690803677417, '2013-04': -4.7779802425307665, '2013-05': -13.780002116899592, '2013-06': -14.931466824603469, '2013-07': -15.114387106872451, '2013-08': -12.149191810351956, '2013-09': -13.157554230793878, '2013-10': -15.948230545884723, '2013-11': -17.42848471399836, '2013-12': -22.819377018258724, '2014-01': -17.166018039850616, '2014-02': -18.278110952241544, '2014-03': -23.653654883322204, '2014-04': -23.11070471192703, '2014-05': -26.1766124617425, '2014-06': -18.939982817407707, '2014-07': -18.617994061516296, '2014-08': -20.384156379937956, '2014-09': -19.60867287103174, '2014-10': -19.308783959166952, '2014-11': -17.248142648990516, '2014-12': -16.517538454191126, '2015-01': -19.915107429352062, '2015-02': -13.678658272658616, '2015-03': -1.1978342640895812, '2015-04': -7.157688366890625, '2015-05': -1.3899274145277807, '2015-06': -3.7810626013397353, '2015-07': -2.6721615895535344, '2015-08': -1.0794653546652433, '2015-09': 3.2843866700115854, '2015-10': 8.907937249577147, '2015-11': 17.84239894933013, '2015-12': 25.02665671382891, '2016-01': 26.744365569983476, '2016-02': 29.458277984005953, '2016-03': 41.03269437960175, '2016-04': 51.658352320665045, '2016-05': 53.975809727656184, '2016-06': 53.823439197834965, '2016-07': 49.98278303849908, '2016-08': 63.309765807418586, '2016-09': 71.89126247385526, '2016-10': 81.05151046582664, '2016-11': 86.19167683397978, '2016-12': 97.06005590570956, '2017-01': 101.78923369261553, '2017-02': 108.45664341692766, '2017-03': 99.2568251413756, '2017-04': 96.52544782436362, '2017-05': 91.46718279929587, '2017-06': 83.72600610888033, '2017-07': 84.45752006255915, '2017-08': 88.91689331999189, '2017-09': 96.3481517296561, '2017-10': 105.58486442346702, '2017-11': 104.53554112178848, '2017-12': 104.3494168026625, '2018-01': 112.55725795668896, '2018-02': 118.35272609891825, '2018-03': 114.78509787141782, '2018-04': 110.08842503787291, '2018-05': 106.12880200463448, '2018-06': 102.860063548256, '2018-07': 100.25390283609687, '2018-08': 100.68172017711686, '2018-09': 96.95892321287339, '2018-10': 108.72925271084077, '2018-11': 106.36669182098059, '2018-12': 107.99922481729993, '2019-01': 103.30306733410444, '2019-02': 125.04790861650457, '2019-03': 138.61753145515848, '2019-04': 141.8135792526273, '2019-05': 141.33044819663806, '2019-06': 137.82543862420064, '2019-07': 145.75978312670247, '2019-08': 148.57734775948174, '2019-09': 145.99262642444387, '2019-10': 159.71792478588438, '2019-11': 161.37270910135803, '2019-12': 165.5244939497826, '2020-01': 177.03804580673176, '2020-02': 195.37446309180288, '2020-03': 178.84855713423087, '2020-04': 155.54608411053513, '2020-05': 179.54409471886632, '2020-06': 187.90823533135202, '2020-07': 187.82011630606155, '2020-08': 206.51373696133706, '2020-09': 225.27762665420795, '2020-10': 216.32747876586672, '2020-11': 198.05039000184465, '2020-12': 224.14816161964924, '2021-01': 234.86031222602892, '2021-02': 254.99558781462258, '2021-03': 261.7786978332588, '2021-04': 272.3606253521895, '2021-05': 278.9672124322836, '2021-06': 289.8828907337928, '2021-07': 292.76634228554167, '2021-08': 288.63181514437287, '2021-09': 319.27251814250485, '2021-10': 337.0357377808675, '2021-11': 376.10466582839604, '2021-12': 350.2893719821402, '2022-01': 336.35498009654043, '2022-02': 321.7542825073764, '2022-03': 230.24413576930183, '2022-04': 283.126881943208, '2022-05': 276.9700148274908, '2022-06': 261.2808982808934, '2022-07': 253.22983423752592, '2022-08': 256.66254003082094, '2022-09': 276.6627084844829, '2022-10': 219.05502026718366, '2022-11': 258.8186825212426, '2022-12': 268.0430819418915}

print("cusr_no_dividend_avg_all: ", cusr_no_dividend_avg_all)
print("curs_below_median_avg_all: ", curs_below_median_avg_all)
print("curs_above_median_avg_all: ", curs_above_median_avg_all)
print("curs_mixed_avg_all: ", curs_mixed_avg_all)


div_no_dividend_avg_all = calculate_difference(cum_no_dividend_avg_all, cusr_no_dividend_avg_all)
div_below_median_avg_all = calculate_difference(cum_below_median_avg_all, curs_below_median_avg_all)
div_above_median_avg_all = calculate_difference(cum_above_median_avg_all, curs_above_median_avg_all)
div_mixed_avg_all = calculate_difference(cum_mixed_avg_all, curs_mixed_avg_all)



plot_returns(cusr_no_dividend_avg_all, div_no_dividend_avg_all, "акций, которые не выплачивают дивиденды")
plot_returns(curs_below_median_avg_all, div_below_median_avg_all, "акций, дивидендная доходность которых ниже медианы")
plot_returns(curs_above_median_avg_all, div_above_median_avg_all, "акций, дивидендная доходность которых выше медианы")
plot_returns(curs_mixed_avg_all, div_mixed_avg_all, "акций, не выплачивающих дивиденды или доходность которых ниже медианы")



def calculate_geometric_returns(numbers):
    periods = {
        '120 months (10 years)': 120,
        '10 years': 10,
        '2 years': 5,
        '5 years': 2,
        '10 years (no root needed)': 1
    }

    for num in numbers:
        modified_value = num / 100 + 1
        print(f"Обработка числа: {num}")
        for period, root in periods.items():
            if root == 1:
                return_value = (modified_value - 1) * 100
            else:
                return_value = (modified_value ** (1 / root) - 1) * 100
            print(f"Геометрическая доходность за {period}: {return_value:.2f}%")


no = [299, 253]
low = [290, 262]
high = [341, 208]
mix = [280, 241]

calculate_geometric_returns(no)
calculate_geometric_returns(low)
calculate_geometric_returns(high)
calculate_geometric_returns(mix)
